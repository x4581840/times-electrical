<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.timeselectrical.mapper.SceneFaultLabelMapperExt">

    <select id="getSceneFaultLabels" resultMap="com.timeselectrical.mapper.SceneFaultLabelMapper.BaseResultMap">
        SELECT
          <include refid="com.timeselectrical.mapper.SceneFaultLabelMapper.Base_Column_List"></include>
        FROM
          scene_fault_label
        <where>
            1=1
            <if test="cond != null and cond.sqn != null and cond.sqn != ''">
                AND f_gzpxh = #{cond.sqn}
            </if>
        </where>
    </select>
          <!--<select id="">-->
              <!--select F_GZPTHWZBM as fGzpthwzbm,F_GZPMC as fGzpmc,F_CXDL as fCxdl,F_ZCCX as fZccx,F_ZYZRDW as fZyzrdw ,sum(COUNT_) as count from "_SYS_BIC"."com.CRRC.POC/CV_XCGZ_V" where F_GZPTHWZBM=#{fGzpthwzbm}-->
              <!--<if test='startTime !=""and endTime !=""'>-->
                  <!--and   F_GZFSSJ between #{startTime}  and #{endTime}-->
              <!--</if>-->
              <!--<if test='startTime !=""and endTime ==""'>-->
                  <!--and   F_GZFSSJ >=#{startTime}-->
              <!--</if>-->
              <!--<if test='startTime ==""and endTime !=""'>-->
                  <!--and   F_GZFSSJ  &lt;=#{endTime}-->
              <!--</if>-->
              <!--group by F_GZPTHWZBM,F_GZPMC,F_CXDL,F_ZCCX,F_ZYZRDW-->
          <!--</select>-->
         <select id="getOneTable" resultType="com.timeselectrical.model.SceneFaultLabel" >
                select f_gzpthwzbm as fGzpthwzbm,f_gzpmc as fGzpmc,f_cxdl as fCxdl,f_zccx as fZccx,f_zyzrdw as fZyzrdw ,sum(count) as count from scene_fault_label where f_gzpthwzbm=#{fGzpthwzbm}
             <if test='startTime !=""and endTime !=""'>
                 and   f_gzfssj between #{startTime}  and #{endTime}
             </if>
             <if test='startTime !=""and endTime ==""'>
                 and   f_gzfssj >=#{startTime}
             </if>
             <if test='startTime ==""and endTime !=""'>
                 and   f_gzfssj  &lt;=#{endTime}
             </if>
             <if test='fGzpmc !=""and fGzpmc !=null'>
                 and   f_gzpmc =#{fGzpmc}
             </if>
           group by f_gzpthwzbm,f_gzpmc,f_cxdl,f_zccx,f_zyzrdw

       </select>


  <!--  <select id="childSelect" resultType="com.timeselectrical.model.SceneFaultLabel" >
        select F_GZPTHWZBM as fGzpthwzbm,F_GZPMC as fGzpmc from "_SYS_BIC"."com.CRRC.POC/CV_XCGZ_V"  where F_GZPTHWZBM like concat('%', #{fGzpthwzbm},'%')
        group by f_gzpmc
    </select>-->

    <select id="childSelect" resultType="com.timeselectrical.model.SceneFaultLabel" >
        select f_gzpthwzbm as fGzpthwzbm,f_gzpmc as fGzpmc,count(1) from scene_fault_label where f_gzpthwzbm like concat('%', #{fGzpthwzbm},'%')
        group by f_gzpthwzbm,f_gzpmc
    </select>

    <!--<select id="linkSelect" resultType="com.timeselectrical.model.copySceneFaultLabel" >
        select F_BDBH as fBdbh,F_XMMC as fXmmc,F_XMH as fXmh,F_SSYJLBJ as fSsyjlbj,F_SCDW as fScdw,F_GZMCf as fGzmc,F_GZDM as fGzdm,F_GZHG as fGzhg,F_GZDJ as fGzdj,
        F_GZFSSJ as fGzfssj from "_SYS_BIC"."com.CRRC.POC/CV_XCGZ_V"
        where F_GZPTHWZBM=#{fGzpthwzbm}
        and F_GZPMC =#{fGzpmc}
        and F_CXDL =#{fCxdl}
        and F_ZCCX =#{fZccx}
        and F_ZYZRDW =#{fZyzrdw}
        <if test='startTime !=""and endTime !=""'>
            and   F_GZFSSJ between #{startTime}  and #{endTime}
        </if>
        <if test='startTime !=""and endTime ==""'>
            and   F_GZFSSJ >=#{startTime}
        </if>
        <if test='startTime ==""and endTime !=""'>
            and   F_GZFSSJ  &lt;=#{endTime}
        </if>
        order by F_GZFSSJ asc
    </select>-->

    <select id="linkSelect" resultType="com.timeselectrical.model.copySceneFaultLabel" >
        select f_bdbh as fBdbh,f_xmmc as fXmmc,f_xmh as fXmh,f_ssyjlbj as fSsyjlbj,f_scdw as fScdw,f_gzmc as fGzmc,f_gzdm as fGzdm,f_gzhg as fGzhg,f_gzdj as fGzdj,
        f_gzfssj as fGzfssj from scene_fault_label
        where f_gzpthwzbm=#{fGzpthwzbm}
        and f_gzpmc =#{fGzpmc}
        and f_cxdl =#{fCxdl}
        and f_zccx =#{fZccx}
        and f_zyzrdw =#{fZyzrdw}
        <if test='startTime !=""and endTime !=""'>
            and   f_gzfssj between #{startTime}  and #{endTime}
        </if>
        <if test='startTime !=""and endTime ==""'>
            and   f_gzfssj >=#{startTime}
        </if>
        <if test='startTime ==""and endTime !=""'>
            and   f_gzfssj  &lt;=#{endTime}
        </if>
        order by f_gzfssj asc
    </select>


</mapper>